# Parallel ZIP File Analyzer - PRD

## Section 1: Core Requirements ğŸ¯

1. CLI tool to analyze a single ZIP file using parallel processing
2. Uses tokio for async I/O and rayon for parallel decompression
3. Outputs analysis to a text file
4. Shows progress bar during analysis
5. Handles large ZIP files (>10GB) efficiently via streaming
6. Provides detailed file statistics and compression info
7. Maintains memory efficiency through chunked processing
8. Graceful error handling
9. Simple CLI: `cargo run -- input.zip output.txt`

## Section 2: Architecture ğŸ—ï¸

"Think of this like a factory assembly line for ZIP files - each part has a specific job, and they all work together like a well-oiled machine!"

ğŸ’¡ High-Level Flow:
```
Input ZIP         Processing Pipeline              Output
   ğŸ“¦     â†’    ğŸ­ [Factory Floor]    â†’         ğŸ“Š Report
(ZIP File)     (Parallel Processing)        (Analysis Text)
```

ğŸ—ï¸ Module Design Visualization:
```
                    main.rs
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â–¼          â–¼          â–¼
       analyzer/   models/     writer/
    (Brain ğŸ§ )   (Data ğŸ“‹)   (Output âœï¸)
```

ğŸ”„ Data Flow Through Modules:
```
ZIP File â†’ [analyzer/zip.rs] â†’ Chunks â†’ [analyzer/chunks.rs] â†’ Results â†’ [writer/report.rs] â†’ Output
   ğŸ“¦          ğŸ”               ğŸ§©             âš¡                ğŸ“Š            âœï¸              ğŸ“„
              Read           Split          Process          Collect       Format          Write
```

ğŸ’¾ Memory Management Flow:
```
                    Memory Pool
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚Bufferâ”‚     â”‚Bufferâ”‚     â”‚Bufferâ”‚   â”‚
â”‚    â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”¬â”€â”€â”€â”˜   â”‚
â”‚       â”‚            â”‚            â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚
    Thread 1     Thread 2     Thread N
     ğŸ§µ           ğŸ§µ           ğŸ§µ
```

ğŸ”„ Parallel Processing Visualization:
```
Input Stream
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chunks  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Thread Pool (rayon)     â”‚
â”‚  ğŸ§µ   ğŸ§µ   ğŸ§µ   ğŸ§µ   ğŸ§µ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Results â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ğŸ“Š Progress Tracking:
```
[====================] 100%
     â†‘            â†‘
  Progress      ETA
   Update     Estimate
```

ğŸ” Error Recovery Strategy:
```
Error Detected
      â”‚
      â–¼
  Recoverable?
      â”‚
  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
  â”‚        â”‚
 Yes      No
  â”‚        â”‚
Retry    Skip
  â”‚        â”‚
  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚
 Continue
```

Key Design Principles:

1. ğŸ¯ Single Responsibility:
   ```
   analyzer/ â†’ Reading & Processing
   models/  â†’ Data Structures
   writer/  â†’ Output Generation
   ```

2. ğŸ”„ Data Flow Control:
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Input    â”‚ â†’  â”‚  Process   â”‚ â†’  â”‚   Output   â”‚
   â”‚  Channel   â”‚    â”‚  Channel   â”‚    â”‚  Channel   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

3. ğŸ§® Memory Management:
   ```
   Available RAM
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ App Limit (80%)            â”‚
   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
   â”‚ â”‚ Buffer Pool        â”‚     â”‚
   â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
   â”‚ â”‚ â”‚Chunk â”‚ â”‚Chunk â”‚  â”‚     â”‚
   â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

## Section 3: Library Architecture ğŸ“š

"Think of libraries like specialized tools in a workshop - each one is perfect for a specific job!"

ğŸ’¡ Core Libraries Overview:
```
tokio (Async Runtime)     rayon (Parallel Processing)     zip-rs (ZIP Handling)
       ğŸš€                           âš¡                            ğŸ“¦
    I/O Engine                Thread Pool                  ZIP Parser
```

ğŸ”§ Library Interactions:
```
                        Application
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                            â–¼
          tokio Runtime                rayon Pool
     (Async I/O Operations)      (CPU-bound Processing)
              â”‚                            â”‚
              â”‚        zip-rs              â”‚
              â”‚           â”‚               â”‚
              â”‚           â–¼               â”‚
              â”‚      Parse Headers        â”‚
              â”‚           â”‚               â”‚
              â”‚           â–¼               â”‚
         Read Chunks â—„â”€â”€â”€â”€â”˜               â”‚
              â”‚                           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
                          â–¼              â–¼
                    Process Chunks    Decompress
                          â”‚              â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                          Write Results
```

ğŸ“Š Library Responsibilities:

```
tokio
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Async File I/O   â”‚
â”‚ â€¢ Event Loop       â”‚
â”‚ â€¢ Task Scheduling  â”‚
â”‚ â€¢ Channel Comms    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

rayon
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Thread Pool      â”‚
â”‚ â€¢ Work Stealing    â”‚
â”‚ â€¢ Parallel Iters   â”‚
â”‚ â€¢ Data Parallelism â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

zip-rs
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ ZIP Parsing      â”‚
â”‚ â€¢ Decompression    â”‚
â”‚ â€¢ CRC Validation   â”‚
â”‚ â€¢ Format Handling  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ğŸ”„ Data Flow Through Libraries:
```
File System â†’ tokio â†’ zip-rs â†’ rayon â†’ tokio â†’ File System
    ğŸ“         ğŸš€      ğŸ“¦       âš¡       ğŸš€        ğŸ“
    Read     Async    Parse  Process   Write    Output
```

ğŸ’¡ Why These Libraries?

```
tokio                      rayon                     zip-rs
  â”‚                          â”‚                         â”‚
  â–¼                          â–¼                         â–¼
Async I/O               CPU Parallelism           ZIP Expertise
  â”‚                          â”‚                         â”‚
  â”‚                          â”‚                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–¼                          â–¼
         Performance ğŸš€              Reliability âœ…
```

ğŸ”„ Integration Pattern:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    tokio    â”‚ â†’   â”‚   zip-rs    â”‚ â†’   â”‚    rayon    â”‚
â”‚ (I/O Layer) â”‚     â”‚(Parse Layer)â”‚     â”‚(CPU Layer)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â–²                                        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               Results Flow Back
```

[Continue with existing content...]


